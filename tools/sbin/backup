#!/bin/bash
PATH=/apps/compbio/i686-linux-2.4/bin:/usr/bin:/bin
case `hostname` in
    svc*|td-svc*)
    	PGHOST=;;
    *) 
    	PGHOST=td-svc;;
esac

export PGHOST
export PGDATABASE=${1:-csb}
export PGPASSWORD=marge

DIR=/home/rkh/csb-db/backups/$PGDATABASE
mkdir -p "$DIR"
DATE=`date +%Y-%m-%d-%H:%M`;
R="$DIR/$DATE.pgdump"

(time -p pg_dump -X use-set-session-authorization -Uadmin "$PGDATABASE" \
 | gzip -c) >"$R".gz 2>"$R".err
