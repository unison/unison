#!/usr/bin/env perl
# $Id: load-pmhmm,v 1.1 2003/06/18 22:39:15 rkh Exp $
# load pfam HMM summary info (not the HMM itself) into unison
# $ load-pmhmm <Pfam_fs

use strict;
use warnings;
use Unison;


my $udb = new Unison;

my $origin = 'Pfam_fs';
my $porigin_id = $udb->porigin_si_porigin_id($origin);
printf(STDERR "# loading sequences into $origin (porigin_id=$porigin_id)\n");

my $sth = $udb->prepare("insert into pmhmm (porigin_id,name,acc,descr,len,nseq,cksum) ".
						"values ($porigin_id,?,?,?,?,?,?)");

$/ = "\nHMMER2.0";
while(my $blk = <>)
  {
  my ($name) = $blk =~ m/^NAME\s+(.+)/m;
  my ($acc) = $blk =~ m/^ACC\s+(.+)/m;
  my ($descr) = $blk =~ m/^DESC\s+(.+)/m;
  my ($len) = $blk =~ m/^LENG\s+(\d+)/m;
  my ($nseq) = $blk =~ m/^NSEQ\s+(\d+)/m;
  my ($cksum) = $blk =~ m/^CKSUM\s+(\d+)/m;

  $sth->execute($name,$acc,$descr,$len,$nseq,$cksum);
  }
